import pandas as pd
import numpy as np

malData = pd.read_csv('datasetmalware.csv', sep="|")

legit = malData[0:41323].drop(["legitimate"], axis=1)
mal = malData[41323::].drop(["legitimate"], axis=1)

print("the shape of legit dataset is: %s samples, %s features"%(legit.shape[0],legit.shape[1]))
print("the shape of malware dataset is: %s samples, %s features"%(mal.shape[0],mal.shape[1]))

pd.set_option("display.max_columns", None)
print(malData.head(5))

from sklearn.ensemble import ExtraTreesClassifier
from sklearn.feature_selection import SelectFromModel
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_validate

data_in = malData.drop(['Name','md5','legitimate'], axis=1).values
labels = malData['legitimate'].values
extratrees = ExtraTreesClassifier().fit(data_in,labels)
select = SelectFromModel(extratrees,prefit=True)
data_in_new = select.transform(data_in)
print(data_in.shape,data_in_new.shape)

features = data_in_new.shape[1]
importances = extratrees.feature_importances_
indices = np.argsort(importances)[::-1]

for f in range(features):
	print("%d"%(f+1),malData.columns[2+indices[f]],importances[indices[f]])
